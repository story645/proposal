\documentclass[xcolor={dvipsnames}, handout]{beamer}

\usepackage{amsmath,amsfonts,amssymb,pxfonts,eulervm,xspace}
\usepackage{mathrsfs} % math script fonts
\usepackage{tikz-cd} % commutative diagrams
\usepackage{subcaption} % subfigure float captioning

\usepackage{tabularx}
\usepackage{multirow}
\usepackage{graphicx}

\usepackage{notation} % move this later

\graphicspath{.figures/}

\usepackage[backend=bibtex, style=numeric-comp, doi=false,isbn=false,url=false, giveninits=true]{biblatex}
\bibliography{../draft/glasslab_viz.bib}

\usetheme{ccnycrest}

\newenvironment{changemargin}[2]{%
\begin{list}{}{%
\setlength{\topsep}{0pt}%
\setlength{\leftmargin}{#1}%
\setlength{\rightmargin}{#2}%
\setlength{\listparindent}{\parindent}%
\setlength{\itemindent}{\parindent}%
\setleng{}th{\parsep}{\parskip}%
}%
\item[]}{\end{list}}

\begin{document}

\title{Topological Equivariant Artist Model}

\begin{frame}
	\titlepage
    Hannah Aizenman\\
    Advisor: Dr. Michael Grossberg \\
    Committee: Dr. Robert Haralick, Dr. Lev Manovich, Dr. Huy Vo\\
    External Member: Dr. Marcus Hanwell
\end{frame}

\section{Introduction}

\begin{frame}{Visualizations are structure preserving maps}
    \begin{figure}
        \includegraphics[width=1\linewidth]{figures/intro/dar.png}
    \end{figure}
    The aim of this work is to rearchitecture Matplotlib
    \pause 
    to take advantage of developments in software design, data structures, and visualization
    \pause
    to improve consistency, reusability, and discoverability,
    \pause
    so domain specific tool developers can build structure preserving visualization tools.
\end{frame}

\begin{frame}{Visualization component constraints}
    \begin{description}
        \item[equivariance] properties of data and visual encoding match
        \item[continuity] connectivity of data and visual encoding match
        \item[composibility] structure preserved by individual components is preserved in combined components
    \end{description}
\end{frame}

\subsection{Background}
\begin{frame}{Tools are tuned to the continuity of the date \cite{HeerSoftware2006,toryRethinkingVisualizationHighlevel2004}}
    \begin{columns}
        \column{0.33\textwidth}
        \begin{figure}
            \includegraphics[width=1\textwidth]{figures/intro/data_formatting.png}
            \caption{Based on fig~2.5 in Munzner's VAD\cite{VisualizationAnalysisDesign}}
        \end{figure}
    
        \begin{enumerate}
            \item ggplot\cite{wickhamGgplot2ElegantGraphics2016a}
            \item protovis\cite{bostockProtoviz2009}, D3 \cite{bostockDataDrivenDocuments2011}
            \item vega\cite{satyanarayanDeclarativeInteractionDesign2014}, altair\cite{vanderplasAltairInteractiveStatistical2018}
        \end{enumerate}
        \pause
        \column{0.33\textwidth}
        \begin{figure}
            \includegraphics[width=1\textwidth]{figures/intro/landsat.png}
        \end{figure}
        \begin{enumerate}
            \item ImageJ\cite{schneiderNIHImageImageJ2012}, ImagePlot\cite{studiesCulturevisImageplot2021}\item Napari\cite{nicholas_sofroniew_2021_4533308}
        \end{enumerate}
        \pause
        \column{0.33\textwidth}
        \begin{figure}
            \includegraphics[width=1\textwidth]{figures/intro/dataset_diagram.png}
            \caption{Data Representation, MayaVi 4.7.2 docs\cite{DataRepresentationMayavi}}
        \end{figure}
        \begin{enumerate}
            \item Matplotlib\cite{hunterMatplotlib2DGraphics2007}, 
            \item VTK \cite{hanwellVisualizationToolkitVTK2015,geveci2012vtk}, MayaVi\cite{RamachandranMayaVI2011}, ParaView\cite{ahrens2005paraview}, Titan\cite{brianwylieUnifiedToolkitInformation2009}
        \end{enumerate}
    \end{columns}
\end{frame}

\begin{frame}{Structure is encoded in variables and continuity}
    \begin{figure}
        \includegraphics[width=1\textwidth]{figures/intro/munzner_datatypes.png}
        \caption{Image is figure 2.8 in Munzner's Visualization Analysis and Design\cite{munznerVisualizationAnalysisDesign2014}}
    \end{figure}
    \begin{description}
        \item[binding] metadata are structural \textit{keys} with associated \textit{values} (Munzner \cite{munznerVisualizationAnalysisDesign2014})] 
        \item[continuity] Fiber bundles can be a common data abstraction (Butler \cite{butlerVectorBundleClassesForm1992,butlerVisualizationModelBased1989})
        \item[variables] Fibers can hold schema like encodings of variables (Spivak \cite{spivakDatabasesAreCategories2010,spivakSIMPLICIALDATABASES})
    \end{description}
\end{frame}

\begin{frame}{Visualizations are (mostly) evaluated on equivariance}
    \begin{description}
        \item[Expressiveness] structure preserving mappings from data to graphic (Mackinlay \cite{mackinlayAutomatingDesignGraphical1986})
        \item[Effectiveness] design choices made in deference to perceptual saliency \cite (Mackinlay \cite{clevelandResearchStatisticalGraphics1987,clevelandGraphicalPerceptionTheory1984,chambersGraphicalMethodsData1983a, munznerVisualizationAnalysisDesign2014})
        \item[Naturalness] easier to understand when properties match (Norman \cite{norman_things_smart})
        \item[Graphical Integrity] graphs show \textbf{only} the data (Tufte \cite{tufteVisualDisplayQuantitative2001})
    \end{description}
\end{frame}


\begin{frame}{Models describe composition}
    \begin{description}
        \item[language model] APT: syntax and semantics of visualization (Mackinlay  \cite{mackinlayAutomatingDesignGraphical1986, mackinlayAUTOMATICDESIGNGRAPHICAL1987})
        \item[functional dependencies] constrained maps between data and visual representation(Sugibuchi \cite{sugibuchiFramwork2009}) 
        \item[category theory] the semiotics of visualization are commutative (Vickers \cite{vickersUnderstandingViz2013})
        \item[algebraic process] data ($\alpha$) and viz ($\omega$) transforms are symmetric (Kindlmann and Scheidegger \cite{kindlmannAlgebraicProcessVisualization2014})
        \begin{columns}
            \column{.5\textwidth}
       
            \begin{description}
                \item[D] data 
                \item[R] representations
                \item[V] visualizations
            \end{description}
            \column{.5\textwidth}
            \begin{equation*}
                \begin{tikzcd}[ampersand replacement=\&]
                    D \arrow[d, "\alpha"'] \arrow[r, "r_1"] \& R \arrow[r, "\nu"]  \& V \arrow[d, "\omega"] \\
                    D \arrow[r, "r_2"']                     \& R \arrow[r, "\nu"'] \& V                    
                \end{tikzcd}
                \end{equation*}
       
        \end{columns} 
     
    \end{description}
\end{frame}


\subsection{Contributions}
\begin{frame}{Contributions}
    \begin{description}
        \item[Topological] topology preserving relationship between data and graphic via continuous maps
        \item[Equivariant] property preservation from data component to visual representation as equivariant maps that carry a homomorphism of monoid actions
        \item[Artist] functional oriented visualization tool architecture built on the mathematical model to demonstrate the utility of the model
        \item [Model] prototype of the architecture built on Matplotlib's infrastructure to demonstrate the feasibility of the model
    \end{description}
\end{frame}

\section{Mathematical Framework}

\begin{frame}{Topological Equivariant Artist Model}
    The Artist $\mathscr{\vartist}$ is a map from data $\mathscr{\dtotal}$ to graphic $\mathscr{\gtotal}$
    \begin{equation}
        \mathscr{\vartist}: \mathscr{\dtotal} \rightarrow \mathscr{\gtotal}
    \end{equation}
    \pause
     that carries a homomorphism of monoid actions 
    \begin{equation}
    \varphi: \monoid \rightarrow \monoid^{\prime}
    \end{equation}
    \pause
    such that artists are equivariant maps 
    \begin{equation}
    \mathscr{\vartist}(m\cdot \delement) = \varphi(m)\cdot\mathscr{\vartist}(\delement) 
    \end{equation}
    \pause 
    with a deformation retraction from graphic to data space. 
    \note{some kinda words about the continuity}
\end{frame}

\subsection{Data Model}

\begin{frame}{Data Bundle}
    \begin{figure}
        \includegraphics[width=1\textwidth]{figures/math/fiberbundle.png}
    \end{figure}
    a fiber bundle is a tuple $(\dtotal,\,\dbase,\,\pi ,\,\dfiber)$ defined by the projection map $\pi$
    \begin{equation}
        \label{eq:fiber_bundle}
        \begin{tikzcd}[ampersand replacement=\&]
            \dfiber \arrow[r, hook] \& \dtotal \arrow[r, "\pi"] \& \dbase
        \end{tikzcd}
    \end{equation}
\end{frame}

\begin{frame}{Variables: Fiber}
    \begin{equation}
        \dfiber = \ftotal_{\fsection(\fname)} = \ftotal_{\ftype} 
    \end{equation}
    where $\ftotal_{\fsection(\fname)}$ is 
    \begin{equation}
        \label{eq:data_types}
        \begin{tikzcd}[ampersand replacement=\&]
            \fttype \arrow[r] \arrow[d, "\pi_{\fsection}"'] \& \ftotal \arrow[d, "\pi"] \\
            \fnames \arrow[r, "\fsection"']                  \& \ftypes       
        \end{tikzcd}
    \end{equation}
    \begin{description}
        \item[\ftypes] data types of the variables in the dataset 
        \item[\ftotal] disjoint union of all values of type $\ftype \in \ftypes$ 
        \item[\fnames] variable names
        \item[\fttype] \ftotal\ restricted to the data type of a named variable   
    \end{description}
\end{frame}

\begin{frame}{Sample Fiber}
    \begin{figure}[H]
        \begin{subfigure}{.4\textwidth}
            \includegraphics[width=\textwidth]{figures/math/temp_1k.png}
            \caption{}
            \label{fig:fiber_example_plane}
        \end{subfigure}
        \begin{subfigure}{.4\textwidth}
            \includegraphics[width=\textwidth]{figures/math/temp_3f.png}
            \caption{}
            \label{fig:fiber_example_cube}
        \end{subfigure}
        \caption{}
        \label{fig:data_fiber_example}
    \end{figure}
    \begin{description}
        \item[\ref{fig:fiber_example_plane}]  $\dfiber=\reals\times\reals$, for example (time, temperature)
        \item[\ref{fig:fiber_example_cube}]  $\reals\times\realsp\times\reals$, for example  (time, wind=(speed, direction))
    \end{description}
\end{frame}


\begin{frame}{Structure of Components: Monoids}
A monoid \monoid\ is a set with
\begin{description}
    \item[associative binary operator] $\ast:\monoid \times \monoid\rightarrow \monoid$
    \item[identity element] $e\in \monoid$ such that $e\ast a= a \ast e = a$ for all $a \in \monoid$. 
\end{description}
\end{frame}
\begin{frame}{Monoid Actions}
A left monoid action of $\monoid_i$ is a set $\dfiber_i$ with an action $\bullet: \monoid\times \dfiber_i \rightarrow \dfiber_i$ with the properties:
    \begin{align*}
        \textbf{associativity}\;& \text{for all } f,g \in \monoid_i \text{ and } x\in \dfiber_i,\, f\bullet(g\bullet x) = (f\ast g) \bullet x\\
        \textbf{identity}\;& \text{for all } x\in \dfiber_i, e\in \monoid_i,\,  e\bullet x = x 
    \end{align*}
\end{frame}

\begin{frame}{Monoid Composition: Permutation}
    \begin{figure}
        \includegraphics[width=1\linewidth]{figures/math/monoid_emoji.png}
    \end{figure}
\end{frame}

\begin{frame}{Monoid Composition: Partial Order}
    \begin{figure}
        \begin{overprint}
            \onslide<1|handout:0>\includegraphics[width=1\linewidth]{figures/math/monoid_hasse.png}
            \onslide<2|handout:0>\includegraphics[width=1\linewidth]{figures/math/monoid_monotone.png}
            \onslide<3>\includegraphics[width=1\linewidth]{figures/math/monoid_maps.png}
        \end{overprint}
    \caption{Inspired by definition 1.59 diagram in Spivak and Fong's An Invitation to Applied Category Theory \cite{fongInvitationAppliedCategory2019}}
    \end{figure}
\end{frame}

\begin{frame}{Continuity: base space}
    \begin{figure}[H]
    \includegraphics[width=\linewidth]{figures/math/k_qspace.png}
    \caption{}
    \label{fig:base_space_div}
\end{figure}
where the total space can be decomposed into components 
\begin{equation}
    \pi:\dtotal_1\oplus\ldots\oplus \dtotal_i \oplus\ldots \oplus \dtotal_n \rightarrow \dbase
\end{equation}
\end{frame}

\begin{frame}{Sample: Base Space}
    \begin{figure}[H]
        \begin{subfigure}{.4\textwidth}
            \includegraphics[width=\textwidth]{figures/math/temp_1k.png}
            \label{fig:base_example_discrete}
        \end{subfigure}
        \begin{subfigure}{.4\textwidth}
            \includegraphics[width=\textwidth]{figures/math/temp_2f.png}
            \label{fig:base_example_continuous}
        \end{subfigure}
        \label{fig:base_example}
    \end{figure}
\end{frame}

\begin{frame}{Values: Section}
    For any fiber bundle, there exists a map
    \begin{equation}
        \begin{tikzcd}[ampersand replacement=\&]
            \dfiber \arrow[r, hook] \& \dtotal \arrow[d, "\pi"'] \\
                              \& \dbase \arrow[u, "\dsection"', bend right]
        \end{tikzcd}
    \end{equation}
     such that $\pi(\dsection(\dbasepoint)) = \dbasepoint$. 
     
     The set of all global sections is denoted as $\Gamma(\dtotal)$.
\end{frame}

\begin{frame}{Record}
    Assuming a trivial fiber bundle $\dtotal = \dbase \times \dfiber$, the section is 
\begin{equation}
    \label{eq:section_return}
    \dsection(\dbasepoint) = (\dbasepoint, (g_{\dfiber_{0}}(\dbasepoint), \ldots, g_{\dfiber_{n}}(\dbasepoint)))
\end{equation}
where $g: \dbase \rightarrow \dfiber$ is the index function into the fiber.
\end{frame}

\begin{frame}{Sample dataset}
    \begin{figure}[H]
        \includegraphics[width=1\linewidth]{figures/math/fiberbundle.png}
        \label{fig:data_sections}
    \end{figure}
\end{frame}

\subsection{Graphics}
\begin{frame}{Graphic Bundle}
    The graphics bundle is a tuple $(\gtotal,\,\gbase,\,\pi ,\,\gfiber)$ defined by the projection map $\pi$
    \begin{equation}
        \label{eq:fiber_bundle}
        \begin{tikzcd}[ampersand replacement=\&]
            \gfiber \arrow[r, hook] \& \gtotal \arrow[r, "\pi"] \& \gbase
        \end{tikzcd}
    \end{equation}
\end{frame}
\begin{frame}{Continuity: Base space}
    The surjective map $\vindex: \gbase \rightarrow \dbase$ 
    \begin{equation}
        \begin{tikzcd}[ampersand replacement=\&]
            \dtotal \arrow[d, "\pi"'] \& \gtotal \arrow[d, "\pi"'] \\
            \dbase                   \& \gbase \arrow[l, "\vindex"']
        \end{tikzcd}
    \end{equation}
    goes from region $\gbasepoint \in \gbase_{\dbasepoint}$ to its associated point $\gbasepoint$. 
\end{frame}

\begin{frame}{Sample Display Target: Fiber}
    Assume a 2D opaque image $\gfiber=\reals^5$ with elements 
    \begin{equation}
    (x,\, y,\, r,\, g,\, b) \in \gfiber
    \end{equation}
    such that a rendered graphic only has 2D position and color.
\end{frame}

\begin{frame}{Continuity Retraction Maps}   
    \begin{figure}[H]
        \includegraphics[width=1\textwidth]{figures/math/retraction_maps.png}
        \label{fig:graphic_retraction_map}
    \end{figure}
\end{frame}

\begin{frame}{Rendering: Define a Pixel}
    \begin{columns}
        \column{0.5\textwidth}
        Given a pixel
        \begin{equation}
        p=\left[y_{top}, y_{bottom}, x_{right}, x_{left}\right]
        \end{equation}
        the inverse map of the bounding box 
        \begin{equation}
        \gbase_{p} ={\gsection_{xy}}^{-1}(p)
        \end{equation}
        is a region $\gbase_p \subset \gbase$ such that 
        \begin{align}
            \scriptstyle r_p &= \scriptstyle \iint\limits_{S_p} \rho_r(s)ds^{2}\\
            \scriptstyle g_p &= \scriptstyle \iint\limits_{S_p} \rho_g(s)ds^{2}\\
            \scriptstyle  b_p &= \scriptstyle \iint\limits_{S_p} \rho_b(s)ds^{2}
        \end{align}
        yields the color of the pixel. 
        \column{0.5\textwidth}
        \begin{figure}[H]
            \includegraphics[width=\textwidth]{figures/math/render.png}
        \end{figure}
    \end{columns}
\end{frame}

\subsection{Artist}



\section{References}
%\begin{frame}[allowframebreaks]{References}
%\printbibliography
%\end{frame}

\end{document}

